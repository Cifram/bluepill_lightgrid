use crate::pattern::StatelessPattern;

pub struct FlamePattern {}

impl FlamePattern {
    pub fn new() -> FlamePattern {
        FlamePattern {}
    }
}

const FRAME_COUNT: usize = 14;
const ANIMATION: [[(u8, u8, u8); 16]; FRAME_COUNT] = [
    [ (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0) ],
    [ (16, 14, 0), (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0) ],
    [ (16, 14, 0), (16, 14, 0), (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [ (16, 14, 0), (16, 14, 0), (16, 14, 0), (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [ (16, 14, 0), (16, 14, 0), (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [ (16, 14, 0), (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0) ],
    [ (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (1, 0, 0), (0, 0, 0) ],

    [ (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0) ],
    [ (16, 14, 0), (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0) ],
    [ (16, 14, 0), (16, 14, 0), (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [ (16, 14, 0), (16, 14, 0), (16, 14, 0), (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [ (16, 14, 0), (16, 14, 0), (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0)],
    [ (16, 14, 0), (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0) ],
    [ (16, 12, 0), (16, 8, 0), (16, 4, 0), (16, 2, 0), (16, 1, 0), (10, 0, 0), (4, 0, 0), (2, 0, 0), (1, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0), (0, 0, 0) ],
];
const RANDOMIZER: [usize; 16] = [ 14, 6, 9, 5, 3, 7, 15, 11, 10, 12, 4, 13, 1, 2, 8, 0 ];

impl StatelessPattern for FlamePattern {
    fn get_pixel(x: usize, y: usize, frame: u32) -> (u8, u8, u8) {
        ANIMATION[((frame as usize) + RANDOMIZER[x % 16]) % FRAME_COUNT][15 - y]
    }
}
